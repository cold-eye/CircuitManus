<!DOCTYPE html>
<html lang="zh-CN"> <!-- 设置页面语言为简体中文 -->
<head>
    <meta charset="UTF-8"> <!-- 设置字符编码为 UTF-8 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- 设置视口，用于响应式设计 -->
    <title>IDT Agent Pro - 智能交互终端</title> <!-- 页面标题 -->
    <!-- 引入 Font Awesome 图标库 (使用较新版本以获取更多图标和特性) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 引入 Animate.css 动画库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <!-- 链接到自定义的 CSS 样式文件 -->
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <!-- 页面加载动画容器 -->
    <div class="loader-container" id="loader">
        <div class="loader-logo"> <!-- 加载动画中的 Logo -->
            <i class="fas fa-microchip fa-beat"></i> <!-- Font Awesome 微芯片图标，并应用跳动效果 -->
            <span>IDT Agent</span>
        </div>
        <div class="loader-progress-bar"> <!-- 加载进度条容器 -->
            <div class="loader-progress"></div> <!-- 实际的进度条 -->
        </div>
        <p class="loading-text">系统模块加载中...</p> <!-- 加载提示文本 -->
    </div>

    <!-- 主应用容器 (加载完成后显示) -->
    <div class="main-container" id="main-container">
        <!-- 顶部导航栏 -->
        <header class="header">
            <div class="logo"> <!-- Logo 区域 -->
                <div class="logo-icon"><i class="fas fa-brain fa-fade"></i></div> <!-- 大脑图标，应用渐隐渐现效果 -->
                <h1>IDT Agent <span class="version-pro">Pro v8.1.0</span></h1> <!-- 应用名称和版本号 -->
            </div>
            <div class="header-buttons"> <!-- 头部操作按钮区域 -->
                <button id="theme-toggle" class="header-btn" title="切换主题"> <!-- 主题切换按钮 -->
                    <i class="fas fa-moon"></i> <!-- 默认显示月亮图标 (浅色主题下) -->
                </button>
                <button id="clear-chat" class="header-btn" title="清空当前对话"> <!-- 清空聊天按钮 -->
                    <i class="fas fa-eraser"></i> <!-- 橡皮擦图标 -->
                </button>
                <button id="manage-sessions-toggle" class="header-btn" title="管理会话 / 收起侧边栏"> <!-- 管理会话/侧边栏切换按钮 -->
                    <i class="fas fa-list-alt"></i> <!-- 列表图标 -->
                </button>
            </div>
        </header>

        <!-- 聊天界面主容器 -->
        <div class="chat-container">
            <!-- 左侧功能选项与会话管理栏 -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-main-actions"> <!-- 主要功能模式切换按钮 -->
                    <button class="sidebar-button active" data-mode="chat" title="对话模式">
                        <i class="fas fa-comments"></i>
                        <span>对话</span>
                    </button>
                    <button class="sidebar-button" data-mode="code" title="编程助手">
                        <i class="fas fa-laptop-code"></i>
                        <span>编程</span>
                    </button>
                    <button class="sidebar-button" data-mode="circuit" title="电路设计">
                        <i class="fas fa-microchip"></i> <!-- 微芯片图标，与加载 Logo 一致 -->
                        <span>电路</span>
                    </button>
                    <button class="sidebar-button" data-mode="settings" title="打开设置">
                        <i class="fas fa-sliders-h"></i> <!-- 滑块设置图标 -->
                        <span>设置</span>
                    </button>
                </div>

                <!-- 会话管理区域 (可折叠) -->
                <div class="session-manager" id="session-manager">
                    <div class="session-manager-header" id="session-manager-toggle"> <!-- 会话历史折叠/展开触发器 -->
                        <span><i class="fas fa-history"></i> 会话历史</span>
                        <i class="fas fa-chevron-down toggle-icon"></i> <!-- 向下箭头图标，用于指示折叠状态 -->
                    </div>
                    <div class="session-list-container" id="session-list-container"> <!-- 会话列表容器 -->
                        <ul class="session-list" id="session-list">
                            <!-- 会话列表项将通过 JavaScript 动态添加到这里 -->
                        </ul>
                        <button id="create-new-session" class="new-session-btn" title="创建新会话"> <!-- 新建会话按钮 -->
                            <i class="fas fa-plus-circle"></i> 新建对话
                        </button>
                    </div>
                </div>
            </div>

            <!-- 聊天区域 -->
            <div class="chat-area">
                <div class="chat-header" id="chat-header"> <!-- 聊天区域顶部，显示当前会话名称等 -->
                    <h2 id="current-session-name">默认会话</h2> <!-- 当前会话名称 -->
                    <button id="edit-session-name-btn" class="icon-btn" title="编辑会话名称"><i class="fas fa-pencil-alt"></i></button> <!-- 编辑会话名称按钮 -->
                </div>

                <!-- Agent 处理过程日志区域 (默认隐藏) -->
                <div class="process-log-container" id="process-log-container" style="display: none;">
                    <div class="process-log-header"> <!-- 日志区域头部，包含标题和折叠按钮 -->
                        <span><i class="fas fa-stream"></i> 处理日志</span>
                        <button class="icon-btn" id="toggle-process-log" title="折叠/展开日志"><i class="fas fa-chevron-up"></i></button>
                    </div>
                    <div class="process-log-content" id="process-log-content">
                        <!-- Agent 处理步骤的日志将动态添加到这里 -->
                        <!-- 示例: <div class="log-item status-planning-started"><i class="fas fa-spinner fa-spin"></i> 规划开始...</div> -->
                    </div>
                </div>

                <!-- 聊天消息显示框 -->
                <div class="chat-box" id="chat-box">
                    <!-- 初始欢迎消息 -->
                    <div class="message system-message animate__animated animate__fadeInUp"> <!-- 系统消息，带入场动画 -->
                        <div class="message-content">
                            <div class="welcome-header">
                                <i class="fas fa-robot robot-icon animate__animated animate__pulse animate__infinite"></i> <!-- 机器人图标，带脉冲动画 -->
                                <h2>IDT 智能助手 Pro <span class="version-tag">v8.1.0</span></h2>
                            </div>
                            <p>我是您的电路设计与编程高级助理！</p>
                            <div class="capabilities"> <!-- 展示助手能力的标签 -->
                                <div class="capability"><i class="fas fa-bolt"></i><span>快速响应</span></div>
                                <div class="capability"><i class="fas fa-brain"></i><span>深度分析</span></div>
                                <div class="capability"><i class="fas fa-code-branch"></i><span>多任务处理</span></div>
                            </div>
                             <div class="quick-actions"> <!-- 快捷操作引导 -->
                                <p>您好！很高兴为您服务。请问有什么可以帮助您的？您可以尝试：</p>
                                <ul> <!-- 快捷指令列表 -->
                                    <li><a href="#" class="quick-action-btn" data-message="添加一个1kΩ的电阻R1">添加电阻 R1</a></li>
                                    <li><a href="#" class="quick-action-btn" data-message="添加一个3V的电池B1">添加电池 B1</a></li>
                                     <li><a href="#" class="quick-action-btn" data-message="将R1和B1连接起来">连接 R1 和 B1</a></li>
                                    <li><a href="#" class="quick-action-btn" data-message="电路现在什么样？">描述电路</a></li>
                                    <li><a href="#" class="quick-action-btn" data-message="清空当前电路设计">清空电路</a></li>
                                     <li><a href="#" class="quick-action-btn" data-message="给我讲讲什么是RC电路">什么是RC电路？</a></li>
                                </ul>
                             </div>
                        </div>
                    </div>
                </div>

                <!-- 文件上传预览区 (默认隐藏) -->
                <div class="file-preview" id="file-preview">
                    <div class="file-preview-header">
                        <h3><i class="fas fa-paperclip"></i> 待上传文件</h3>
                        <button id="close-preview" class="icon-btn" title="关闭预览"><i class="fas fa-times"></i></button> <!-- 关闭预览按钮 -->
                    </div>
                    <div class="file-preview-content" id="file-preview-content">
                        <!-- 已选择的待上传文件项将动态添加到这里 -->
                    </div>
                </div>

                <!-- 用户输入区域 -->
                <div class="input-area">
                    <button id="attach-button" class="input-action-btn" title="添加附件"> <!-- 添加附件按钮 -->
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <div class="input-wrapper"> <!-- 输入框和覆盖层（如语音按钮、字数统计）的容器 -->
                        <textarea id="user-input" placeholder="请输入您的问题或指令... (Shift+Enter 换行)"></textarea> <!-- 用户输入文本框 -->
                        <div class="input-actions-overlay"> <!-- 覆盖在输入框右下角的操作按钮 -->
                            <button id="mic-button" class="overlay-btn" title="语音输入 (开发中)"> <!-- 语音输入按钮 (开发中) -->
                                <i class="fas fa-microphone-alt"></i>
                            </button>
                             <span id="char-counter" class="char-counter">0/2000</span> <!-- 字符计数器 -->
                        </div>
                    </div>
                    <button id="send-button" class="send-button" title="发送消息"> <!-- 发送按钮 -->
                        <svg viewBox="0 0 24 24" fill="currentColor" class="send-icon"> <!-- 发送图标 (SVG) -->
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
                        </svg>
                        <i class="fas fa-spinner fa-spin send-loading-icon" style="display: none;"></i> <!-- 发送中加载图标 (默认隐藏) -->
                    </button>
                    <input type="file" id="file-input" multiple style="display: none"> <!-- 隐藏的文件选择输入框，由附件按钮触发 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast 提示窗口容器 (用于显示短暂的通知) -->
    <div class="toast-container" id="toast-container"></div>

    <!-- 设置模态框 (默认隐藏) -->
    <div class="modal" id="settings-modal">
        <div class="modal-content animate__animated"> <!-- 模态框内容区域，JS 控制入场动画 -->
            <div class="modal-header">
                <h2><i class="fas fa-cog fa-spin-pulse" style="--fa-animation-duration: 3s;"></i> 个性化设置</h2> <!-- 设置标题，带齿轮旋转动画 -->
                <button id="close-settings" class="icon-btn" title="关闭设置"><i class="fas fa-times"></i></button> <!-- 关闭设置按钮 -->
            </div>
            <div class="modal-body"> <!-- 设置项主体内容 -->
                <div class="setting-group"> <!-- 外观设置组 -->
                    <h3><i class="fas fa-paint-brush"></i> 外观</h3>
                    <div class="setting-item">
                        <label for="theme-select">应用主题</label>
                        <select id="theme-select"> <!-- 主题选择下拉框 -->
                            <option value="light">晨曦之光 (浅色)</option>
                            <option value="dark">静谧之夜 (深色)</option>
                            <option value="auto">智能感知 (跟随系统)</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="font-size">界面字号</label>
                        <input type="range" id="font-size" min="12" max="20" value="16"> <!-- 字号调整滑块 -->
                        <span id="font-size-value">16px</span> <!-- 显示当前字号 -->
                    </div>
                    <div class="setting-item">
                        <label for="animation-level">动画效果</label>
                        <select id="animation-level"> <!-- 动画级别选择 -->
                            <option value="full">完整效果</option>
                            <option value="basic">基本效果</option>
                            <option value="none">无动画</option>
                        </select>
                    </div>
                </div>
                <div class="setting-group"> <!-- 会话体验设置组 -->
                    <h3><i class="fas fa-comment-alt"></i> 会话体验</h3>
                    <div class="setting-item">
                        <label for="auto-scroll">自动滚动至底部</label>
                        <label class="switch"><input type="checkbox" id="auto-scroll" checked><span class="slider round"></span></label> <!-- 开关组件 -->
                    </div>
                    <div class="setting-item">
                        <label for="sound-enabled">消息提示音 (待实现)</label>
                        <label class="switch"><input type="checkbox" id="sound-enabled"><span class="slider round"></span></label>
                    </div>
                     <div class="setting-item">
                        <label for="show-think-bubbles">在日志中显示思考过程</label> <!-- 是否在日志区显示Agent思考过程的开关 -->
                        <label class="switch"><input type="checkbox" id="show-think-bubbles" checked><span class="slider round"></span></label>
                    </div>
                </div>
            </div>
            <div class="modal-footer"> <!-- 模态框底部操作按钮 -->
                <button id="reset-settings" class="secondary-btn">恢复默认</button> <!-- 恢复默认设置按钮 -->
                <button id="save-settings" class="primary-btn"><i class="fas fa-save"></i> 保存设置</button> <!-- 保存设置按钮 -->
            </div>
        </div>
    </div>

    <!-- 链接到 JavaScript 文件 (通常放在 body 底部以优化加载) -->
    <script src="/static/script.js"></script>
</body>
</html>